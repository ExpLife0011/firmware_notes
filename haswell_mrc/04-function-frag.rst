逆向方法：函数部分替换
==================================================

时间：2018.12.22

此前做函数替换，是整体替换整个函数。前几天有了个想法，既然我有了汇编的代码，我可以把一个函数的部分代码用 C 写，然后用函数调用的方式调用这些代码。

有的代码是很容易替换的，这些代码是 MMIO 读写 PCI 配置空间的代码，里面只用了常数和 eax, edx 寄存器，简单地提取出来就行了。

在做了一些代码替换后，原本过长的代码变短，结构也变得更加清楚。对于一些代码，效果很明显，比如 do_raminit 中 PCH 初始化的部分。具体可见 [1]_.

.. [1] https://github.com/mytbk/coreboot/blob/haswell-dumpbin/src/northbridge/intel/haswell/do_raminit_frag.c
